include "gsrs-core.conf"

ix.core.structureIndex.atomLimit = 240

gsrs.validators.substances = [
                               # public Class validatorClass;
                               #  public Class substanceClass;
                               #  public Substance.SubstanceDefinitionType type;

                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.IgnoreValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.NullCheckValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.AutoGenerateUuidIfNeeded",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                               },
                               {
                                 #validates that any structural modifications are effectively non-null
                                 "validatorClass" = "ix.ginas.utils.validation.validators.StructuralModificationsValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.SubstanceStatusValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.RemovePublicIndReferences",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.NamesValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                                 "type" = "PRIMARY"
                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.CodesValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                                 "type" = "PRIMARY"
                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.PrimaryRelationshipsValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                                 "type" = "PRIMARY"
                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.NotesValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                                 "type" = "PRIMARY"
                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.PrimaryDefinitionValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                                 "type" = "PRIMARY"
                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.AlternateDefinitionValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                                 "type" = "ALTERNATIVE"
                               },

                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.ChemicalValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                                 "substanceClass" = "chemical",
                                 #September 2020: additional parameter 'allow0AtomStructures' when true -> user can register blank structures; false -> no blank structures
                                 "parameters"= {"allow0AtomStructures":false }

                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.MixtureValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                                 "substanceClass" = "mixture"
                               },
                               #{
                               #  "validatorClass" = "ix.ginas.utils.validation.validators.NucleicAcidValidator",
                               #  "newObjClass" = "ix.ginas.models.v1.Substance",
                                # "substanceClass" = "nucleicAcid"
                              # },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.PolymerValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                                 "substanceClass" = "polymer"
                               },
                               # TODO katzelda FEb 2021 : turn off protein validator for now
                               #{
                               #  "validatorClass" = "ix.ginas.utils.validation.validators.ProteinValidator",
                               #  "newObjClass" = "ix.ginas.models.v1.Substance",
                                # "substanceClass" = "protein"
                               #},
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.StructurallyDiverseValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                                 "substanceClass" = "structurallyDiverse"
                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.SSSG1Validator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",
                                 "substanceClass" = "specifiedSubstanceG1"
                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.UnknownSubstanceClassValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance"
                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.NewSubstanceNonBatchLoadValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",

                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.UpdateSubstanceNonBatchLoaderValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance",

                               },
                               {
                                 "validatorClass" = "ix.ginas.utils.validation.validators.PublicDomainRefValidator",
                                 "newObjClass" = "ix.ginas.models.v1.Substance"
                               },
                                     {
                                       "validatorClass" = "ix.ginas.utils.validation.validators.DefinitionalHashValidator",
                                       "newObjClass" = "ix.ginas.models.v1.Substance"
                                     },

                             	# Added 9 November 2020 MAM
                             	#make sure than a public substance has at least one public definitional reference
                             	{
                                       "validatorClass" = "ix.ginas.utils.validation.validators.DefinitionalReferenceValidator",
                                       "newObjClass" = "ix.ginas.models.v1.Substance"
                                     }

]

##############################################
# THIS IS IMPORTANT, ADDITION OF VALIDATORS!
##############################################

# Validator for Relationship modifications (restrict to admins)
substance.validators += {
                "validatorClass" = "ix.ginas.utils.validation.validators.RelationshipModificationValidator",
                "newObjClass" = "ix.ginas.models.v1.Substance"
        }

        # TODO katzelda FEb 2021 : removed for now until we communicate with CV
#substance.validators += {
#                "validatorClass" = "ix.ginas.utils.validation.validators.CodeFormatValidator",
#                "newObjClass" = "ix.ginas.models.v1.Substance"
#        }

#TODO katzelda Feb 2021: remove for now
#Check that individual moieties of a multi-moiety chemical are registered separately
#substance.validators += {
#          "validatorClass" = "ix.ginas.utils.validation.validators.SaltValidator",
#          "newObjClass" = "ix.ginas.models.v1.ChemicalSubstance"
#        }
#check for uniqueness of several classes of substance based on definitional hashes
#substance.validators += {
#          "validatorClass" = "ix.ginas.utils.validation.validators.SubstanceUniquenessValidator",
#          "newObjClass" = "ix.ginas.models.v1.Substance"
#        }
#Make sure each property has a name
substance.validators += {
           "validatorClass" = "ix.ginas.utils.validation.validators.PropertyValidator",
           "newObjClass" = "ix.ginas.models.v1.Substance"
}

#check the mol files of chemical substances and throw errors if there are SUP s-groups.
#to remove this check comment out or delete this statement.
substance.validators += {
         "validatorClass" = "ix.ginas.utils.validation.validators.SuperatomValidator",
        "newObjClass" = "ix.ginas.models.v1.Substance",
        "substanceClass" = "chemical"

        }

spring.application.name=substance

logging.level.org.springframework.web=DEBUG

server.servlet-path=/loop-service

server.use-forward-headers=true


substance.definitionalElements.implementations = [
{
    "class" = "gsrs.module.substance.definitional.ChemicalSubstanceDefinitionalElementImpl"
},
{
    "class" = "gsrs.module.substance.definitional.MixtureDefinitionalElementImpl"
},
{
    "class" = "gsrs.module.substance.definitional.NonSubstanceConceptDefintionalElementImplementation"
},
{
    "class" = "gsrs.module.substance.definitional.NucleicAcidDefinitionalElementImpl"
},
{
    "class" = "gsrs.module.substance.definitional.ProteinSubstanceDefinitionalElementImpl"
},
{
    "class" = "gsrs.module.substance.definitional.PolymerDefinitionalElementImpl"
},
{
    "class" = "gsrs.module.substance.definitional.SSG1DefinitionalElementImpl"
},
{
    "class" = "gsrs.module.substance.definitional.StructurallyDiverseDefinitionalElementImpl"
},
]